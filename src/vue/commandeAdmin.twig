{% extends "base.twig" %}
{% block title %} Administration | Gestion des commandes{% endblock %}
{% set admin = 'active-admin' %}

{% block contenu %}
<div class="container mt-4">
    <h1 class="mb-4">Gestion des commandes</h1>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Numéro de commande</th>
                    <th>Client</th>
                    <th>Date</th>
                    <th>Total</th>
                    <th>Statut</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% set commandes_exemple = [
                    {
                        'id': 8561487,
                        'nomClient': 'Jean Dupont',
                        'dateCommande': '2024-03-15 14:30',
                        'total': 89.99,
                        'statut': 'En attente'
                    },
                    {
                        'id': 5428971,
                        'nomClient': 'Marie Martin',
                        'dateCommande': '2024-03-14 10:15',
                        'total': 149.50,
                        'statut': 'En préparation'
                    },
                    {
                        'id': 1568374,
                        'nomClient': 'Pierre Durand',
                        'dateCommande': '2024-03-13 16:45',
                        'total': 75.25,
                        'statut': 'Payée'
                    },
                    {
                        'id': 5489894,
                        'nomClient': 'Sophie Leroy',
                        'dateCommande': '2024-03-12 09:20',
                        'total': 199.99,
                        'statut': 'Livrée'
                    }
                ] %}

                {% for commande in commandes_exemple %}
                    <tr>
                        <td>N°{{ commande.id }}</td>
                        <td>{{ commande.nomClient }}</td>
                        <td>{{ commande.dateCommande|date('d/m/Y H:i') }}</td>
                        <td>{{ commande.total }} €</td>
                        <td>
                            <select class="form-select form-select-sm status-select" 
                                    data-commande-id="{{ commande.id }}"
                                    onchange="updateStatus(this)">
                                <option value="En attente" {% if commande.statut == 'En attente' %}selected{% endif %}>
                                    <i class="fas fa-clock"></i> En attente
                                </option>
                                <option value="En préparation" {% if commande.statut == 'En préparation' %}selected{% endif %}>
                                    <i class="fas fa-box"></i> En préparation
                                </option>
                                <option value="Payée" {% if commande.statut == 'Payée' %}selected{% endif %}>
                                    <i class="fas fa-check-circle"></i> Payée
                                </option>
                                <option value="Livrée" {% if commande.statut == 'Livrée' %}selected{% endif %}>
                                    <i class="fas fa-truck"></i> Livrée
                                </option>
                                <option value="Annulée" {% if commande.statut == 'Annulée' %}selected{% endif %}>
                                    <i class="fas fa-times-circle"></i> Annulée
                                </option>
                            </select>
                        </td>
                        <td>
                            <div class="btn-group" role="group">
                                <a href="index.php?page=admin-commande-detail&id={{ commande.id }}" 
                                   class="btn btn-info btn-sm">
                                    <i class="fas fa-eye"></i> Détails
                                </a>
                                <a href="index.php?page=admin-commande-edit&id={{ commande.id }}" 
                                   class="btn btn-primary btn-sm">
                                    <i class="fas fa-edit"></i> Modifier
                                </a>
                                <a href="index.php?page=admin-commande-delete&id={{ commande.id }}" 
                                   class="btn btn-danger btn-sm"
                                   onclick="return confirm('Êtes-vous sûr de vouloir supprimer cette commande ?')">
                                    <i class="fas fa-trash"></i> Supprimer
                                </a>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %} 